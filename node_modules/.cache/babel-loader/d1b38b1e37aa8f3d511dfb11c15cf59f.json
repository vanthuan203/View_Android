{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/KT2/Desktop/ssc.fe.cheatview-main/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/KT2/Desktop/ssc.fe.cheatview-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";var _marked=/*#__PURE__*/_regeneratorRuntime().mark(saga);import{persistReducer}from'redux-persist';import storage from'redux-persist/lib/storage';import{put,takeLatest}from'redux-saga/effects';import{getUserByToken}from'./AuthCRUD';import axios from'utils/AxiosConfig';export var actionTypes={Login:'[Login] Action',Logout:'[Logout] Action',Register:'[Register] Action',UserRequested:'[Request User] Action',UserLoaded:'[Load User] Auth API',SetUser:'[Set User] Action'};var initialAuthState={user:undefined,accessToken:undefined};export var reducer=persistReducer({storage:storage,key:'v1-auth',whitelist:['accessToken']},function(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialAuthState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case actionTypes.Login:{var _action$payload;var accessToken=(_action$payload=action.payload)===null||_action$payload===void 0?void 0:_action$payload.accessToken;return{accessToken:accessToken,user:undefined};}case actionTypes.Register:{var _action$payload2;var _accessToken=(_action$payload2=action.payload)===null||_action$payload2===void 0?void 0:_action$payload2.accessToken;return{accessToken:_accessToken,user:undefined};}case actionTypes.Logout:{return initialAuthState;}case actionTypes.UserRequested:{return _objectSpread(_objectSpread({},state),{},{user:undefined});}case actionTypes.UserLoaded:{var _action$payload3;var user=(_action$payload3=action.payload)===null||_action$payload3===void 0?void 0:_action$payload3.user;return _objectSpread(_objectSpread({},state),{},{user:user});}case actionTypes.SetUser:{var _action$payload4;var _user=(_action$payload4=action.payload)===null||_action$payload4===void 0?void 0:_action$payload4.user;return _objectSpread(_objectSpread({},state),{},{user:_user});}default:return state;}});export var actions={login:function login(accessToken){return{type:actionTypes.Login,payload:{accessToken:accessToken}};},register:function register(accessToken){return{type:actionTypes.Register,payload:{accessToken:accessToken}};},logout:function logout(){return{type:actionTypes.Logout};},requestUser:function requestUser(){return{type:actionTypes.UserRequested};},fulfillUser:function fulfillUser(user){return{type:actionTypes.UserLoaded,payload:{user:user}};},setUser:function setUser(user){return{type:actionTypes.SetUser,payload:{user:user}};}};export function saga(){return _regeneratorRuntime().wrap(function saga$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeLatest(actionTypes.Login,/*#__PURE__*/_regeneratorRuntime().mark(function loginSaga(data){return _regeneratorRuntime().wrap(function loginSaga$(_context){while(1){switch(_context.prev=_context.next){case 0:axios.defaults.headers.common['Authorization']=data.payload.accessToken||\"\";_context.next=3;return put(actions.requestUser());case 3:case\"end\":return _context.stop();}}},loginSaga);}));case 2:_context4.next=4;return takeLatest(actionTypes.Register,/*#__PURE__*/_regeneratorRuntime().mark(function registerSaga(){return _regeneratorRuntime().wrap(function registerSaga$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return put(actions.requestUser());case 2:case\"end\":return _context2.stop();}}},registerSaga);}));case 4:_context4.next=6;return takeLatest(actionTypes.UserRequested,/*#__PURE__*/_regeneratorRuntime().mark(function userRequested(){var _yield$getUserByToken,user;return _regeneratorRuntime().wrap(function userRequested$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getUserByToken();case 2:_yield$getUserByToken=_context3.sent;user=_yield$getUserByToken.data;_context3.next=6;return put(actions.fulfillUser(user.user));case 6:case\"end\":return _context3.stop();}}},userRequested);}));case 6:case\"end\":return _context4.stop();}}},_marked);}","map":{"version":3,"names":["saga","persistReducer","storage","put","takeLatest","getUserByToken","axios","actionTypes","Login","Logout","Register","UserRequested","UserLoaded","SetUser","initialAuthState","user","undefined","accessToken","reducer","key","whitelist","state","action","type","payload","actions","login","register","logout","requestUser","fulfillUser","setUser","loginSaga","data","defaults","headers","common","registerSaga","userRequested"],"sources":["C:/Users/KT2/Desktop/ssc.fe.cheatview-main/src/app/modules/auth/redux/AuthRedux.ts"],"sourcesContent":["import {Action} from '@reduxjs/toolkit'\nimport {persistReducer} from 'redux-persist'\nimport storage from 'redux-persist/lib/storage'\nimport {put, takeLatest} from 'redux-saga/effects'\nimport {UserModel} from '../models/UserModel'\nimport {getUserByToken} from './AuthCRUD'\nimport axios from 'utils/AxiosConfig';\nexport interface ActionWithPayload<T> extends Action {\n  payload?: T\n}\n\nexport const actionTypes = {\n  Login: '[Login] Action',\n  Logout: '[Logout] Action',\n  Register: '[Register] Action',\n  UserRequested: '[Request User] Action',\n  UserLoaded: '[Load User] Auth API',\n  SetUser: '[Set User] Action',\n}\n\nconst initialAuthState: IAuthState = {\n  user: undefined,\n  accessToken: undefined,\n}\n\nexport interface IAuthState {\n  user?: UserModel\n  accessToken?: string\n}\n\nexport const reducer = persistReducer(\n  {storage, key: 'v1-auth', whitelist: ['accessToken']},\n  (state: IAuthState = initialAuthState, action: ActionWithPayload<IAuthState>) => {\n    switch (action.type) {\n      case actionTypes.Login: {\n        const accessToken = action.payload?.accessToken\n        return {accessToken, user: undefined}\n      }\n\n      case actionTypes.Register: {\n        const accessToken = action.payload?.accessToken\n        return {accessToken, user: undefined}\n      }\n\n      case actionTypes.Logout: {\n        return initialAuthState\n      }\n\n      case actionTypes.UserRequested: {\n        return {...state, user: undefined}\n      }\n\n      case actionTypes.UserLoaded: {\n        const user = action.payload?.user\n        return {...state, user}\n      }\n\n      case actionTypes.SetUser: {\n        const user = action.payload?.user\n        return {...state, user}\n      }\n\n      default:\n        return state\n    }\n  }\n)\n\nexport const actions = {\n  login: (accessToken: string) => ({type: actionTypes.Login, payload: {accessToken}}),\n  register: (accessToken: string) => ({\n    type: actionTypes.Register,\n    payload: {accessToken},\n  }),\n  logout: () => ({type: actionTypes.Logout}),\n  requestUser: () => ({\n    type: actionTypes.UserRequested,\n  }),\n  fulfillUser: (user: UserModel) => ({type: actionTypes.UserLoaded, payload: {user}}),\n  setUser: (user: UserModel) => ({type: actionTypes.SetUser, payload: {user}}),\n}\n\nexport function* saga() {\n  yield takeLatest(actionTypes.Login, function* loginSaga(data:any) {\n    axios.defaults.headers.common['Authorization'] = data.payload.accessToken || \"\";\n    yield put(actions.requestUser())\n  })\n\n  yield takeLatest(actionTypes.Register, function* registerSaga() {\n    yield put(actions.requestUser())\n  })\n\n  yield takeLatest(actionTypes.UserRequested, function* userRequested() {\n    const {data: user} = yield getUserByToken()\n\n    yield put(actions.fulfillUser(user.user))\n  })\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}